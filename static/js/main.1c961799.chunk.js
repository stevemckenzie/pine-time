(this["webpackJsonppine-time"]=this["webpackJsonppine-time"]||[]).push([[0],{23:function(t,e,a){t.exports={page:"styles_page__tlI5Y",header:"styles_header__1icdI",logo:"styles_logo__1nkjt",content:"styles_content__ka8Wk"}},24:function(t,e,a){t.exports={button:"styles_button__12U2K",primary:"styles_primary__3HQ5-",secondary:"styles_secondary__2pJ5d",loading:"styles_loading__3E_HN",loadingIndicator:"styles_loadingIndicator__3yut4"}},28:function(t,e,a){t.exports={datePicker:"styles_datePicker__3X6jL",button:"styles_button__2ydJx",calendarContainer:"styles_calendarContainer__7a9RA"}},34:function(t,e,a){t.exports={stationList:"styles_stationList__36qqT",meta:"styles_meta__2u-js"}},35:function(t,e,a){t.exports={home:"styles_home__2W7Yz",searchButton:"styles_searchButton__19h62"}},37:function(t,e,a){"use strict";var n=a(13),r=a(6),i=a(14),c=a(15);e.a=Object(c.c)({stations:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{favorites:[],items:{},stations:{}},e=arguments.length>1?arguments[1]:void 0,a=e.type,c=Object(i.a)(e,["type"]);switch(a){case"FAVORITE_ADD":var s=c.id;if(t.favorites.includes(s))return t;var o=[].concat(Object(r.a)(t.favorites),[s]);return Object(n.a)({},t,{favorites:o});case"FAVORITE_REMOVE":var l=c.id,u=t.favorites.findIndex((function(t){return t===l}));if(-1===u)return t;var m=Object(r.a)(t.favorites);return m.splice(u,1),Object(n.a)({},t,{favorites:m});case"STATIONS_UPDATE":var d=Object(n.a)({},t.stations,{},c.stations);return Object(n.a)({},t,{stations:d});case"STATION_ITEMS_UPDATE":var f=Object(n.a)({},t.items,{},c.items);return Object(n.a)({},t,{items:f});default:return t}},ui:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:0},e=arguments.length>1?arguments[1]:void 0,a=e.type,r=Object(i.a)(e,["type"]);switch(a){case"SET_LOADING":var c=t.loading+r.loading;return Object(n.a)({},t,{loading:c});default:return t}}})},44:function(t,e,a){t.exports={loadingIndicator:"styles_loadingIndicator__89poN"}},45:function(t,e,a){t.exports={search:"styles_search__MREa2"}},46:function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return s}));var n=a(19),r=a(15),i=(a(47),a(48)),c=a(37),s=function(){var t=[i.a.withExtraArgument({})];var e=r.a.apply(void 0,t)(r.d),a=function(){try{var t=localStorage.getItem("state");if(null===t)return;return JSON.parse(t)}catch(e){return}}(),s=e(c.a,a);return s.subscribe((function(){s.subscribe(Object(n.throttle)((function(){!function(t){try{var e=JSON.stringify(t);localStorage.setItem("state",e)}catch(a){console.log("Failed to persist",a)}}({stations:s.getState().stations})}),1e3))})),s}}).call(this,a(39)(t))},51:function(t,e,a){t.exports=a(69)},68:function(t,e,a){},69:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(26),c=a.n(i),s=a(12),o=a(17),l=a(5),u=function(t){return function(e){var a=e.stations.stations;return(void 0===a?{}:a)[t]}},m=function(t){var e=t.stations.stations;return void 0===e?{}:e},d=function(t){var e=t.stations.favorites;return void 0===e?[]:e},f=function(t){return t.ui.loading>0},v=a(14),p=function(t){var e=t.children,a=t.title,n=Object(v.a)(t,["children","title"]);return r.a.createElement(o.b,Object.assign({title:a},n),r.a.createElement("span",null,e||a))},_=a(23),E=a.n(_),h=function(t){var e=t.children,a=t.header;return r.a.createElement("div",{className:E.a.page},r.a.createElement("div",{className:E.a.header},r.a.createElement(p,{className:E.a.logo,to:"/"},r.a.createElement("h1",null,"Pine Time")),a),r.a.createElement("div",{className:E.a.content},e))},b=a(10),y=a.n(b),O=a(34),g=a.n(O),j=function(t){var e=t.stations;return r.a.createElement("ul",{className:g.a.stationList},e.map((function(t){var e=t.id,a=t.lastUpdated,n=t.province,i=t.stationName;return r.a.createElement("li",{key:e},r.a.createElement(p,{title:i,to:"/stations/".concat(e)},r.a.createElement("div",null,r.a.createElement("div",null,i),r.a.createElement("div",null,r.a.createElement("small",null,"Last updated: ",y()(a).format("YYYY-M-D")))),r.a.createElement("div",{className:g.a.meta},n)))})))},N=a(35),T=a.n(N),I=function(){var t=Object(s.c)(d),e=Object(s.c)(m),a=t.map((function(t){return e[t]}));return r.a.createElement(h,{header:r.a.createElement(p,{className:T.a.searchButton,title:"Search for a weather station",to:"/stations/search"})},r.a.createElement("div",{className:T.a.homePage},r.a.createElement(j,{stations:a})))},A=a(2),w=a.n(A),D=a(4),S=a(8),Y=a(50),x=a(13),k=a(19),M=a(22),L={f:"json"},R=function(){var t=Object(D.a)(w.a.mark((function t(e){var a,n,r,i,c,s,o;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.url,n=e.options,r=void 0===n?{}:n,i=e.query,c=void 0===i?{}:i,s=Object(M.stringify)(Object(x.a)({},L,{},Object(k.omitBy)(c,(function(t){return!t})))),t.next=4,fetch("".concat("https://geo.weather.gc.ca/geomet/features/collections").concat(a,"?").concat(s),Object(x.a)({headers:{"Content-Type":"application/json"}},r));case 4:return o=t.sent,t.abrupt("return",o.json());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Object(D.a)(w.a.mark((function t(e){var a,n,r;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.limit,n=void 0===a?30:a,r=e.stationName,t.abrupt("return",R({url:"/climate-stations/items",query:{limit:n,STATION_NAME:r}}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(D.a)(w.a.mark((function t(e){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",R({url:"/climate-stations/items",query:{CLIMATE_IDENTIFIER:e}}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),F=function(){var t=Object(D.a)(w.a.mark((function t(e){var a,n,r,i,c,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,n=e.day,r=e.limit,i=void 0===r?30:r,c=e.month,s=e.year,t.abrupt("return",R({url:"/climate-daily/items/",query:{CLIMATE_IDENTIFIER:a,limit:i,LOCAL_YEAR:s,LOCAL_MONTH:c,LOCAL_DAY:n}}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),U=function(t){return t.map((function(t){var e=t.geometry.coordinates,a=t.id,n=t.properties;return{coordinates:e,id:a,elevation:n.ELEVATION,firstUpdated:n.FIRST_DATE,lastUpdated:n.LAST_DATE,province:n.PROV_STATE_TERR_CODE,stationName:n.STATION_NAME}}))},B=a(3),V=a(16),q=a.n(V),J=a(42),G=a.n(J),H=a(44),W=a.n(H),X=function(t){var e=t.className,a=t.loading,n=void 0===a||a;return r.a.createElement("div",{className:q()(W.a.loadingIndicator,e)},r.a.createElement(G.a,{loading:n}))},z=a(24),K=a.n(z),Q=function(t){var e,a=t.children,n=t.className,i=t.disabled,c=t.kind,s=t.loading,o=void 0!==s&&s,l=t.title,u=Object(v.a)(t,["children","className","disabled","kind","loading","title"]);return r.a.createElement("button",Object.assign({className:q()(K.a.button,(e={},Object(B.a)(e,K.a[c],!!c),Object(B.a)(e,K.a.loading,o),Object(B.a)(e,n,!!n),e)),disabled:i||o,title:l},u),o&&r.a.createElement(X,{className:K.a.loadingIndicator}),r.a.createElement("span",null,a||l))},Z=a(45),$=a.n(Z),tt=function(){var t=Object(Y.a)({mode:"onChange"}),e=t.formState,a=e.isSubmitted,i=e.isSubmitting,c=e.isValid,s=t.handleSubmit,o=t.register,l=Object(n.useState)([]),u=Object(S.a)(l,2),m=u[0],d=u[1],f=a&&!i&&0===m.length,v=function(){var t=Object(D.a)(w.a.mark((function t(e){var a,n,r,i;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.stationName,t.next=3,C({stationName:a});case 3:n=t.sent,r=n.features,i=U(void 0===r?[]:r),d(i);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(h,null,r.a.createElement("div",{className:$.a.search},r.a.createElement("form",{name:"searchForm",onSubmit:s(v)},r.a.createElement("input",{autoFocus:!0,name:"stationName",placeholder:"Search for weather stations...",ref:o({required:!0}),type:"text"}),r.a.createElement(Q,{disabled:!c,kind:"primary",loading:i,title:"Search"})),m.length>0&&r.a.createElement(j,{stations:m}),f&&r.a.createElement("p",null,"No stations found.")))},et=function(t){return function(){var e=Object(D.a)(w.a.mark((function e(a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({loading:t?1:-1,type:"SET_LOADING"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},at=function(t,e){return{type:"STATION_ITEMS_UPDATE",items:Object(B.a)({},t,e)}},nt=a(49),rt=(a(67),a(28)),it=a.n(rt),ct=function(t){var e=t.minDate,a=t.onChange,i=t.title,c=Object(v.a)(t,["minDate","onChange","title"]),s=Object(n.useState)(!1),o=Object(S.a)(s,2),l=o[0],u=o[1];return r.a.createElement("div",{className:it.a.datePicker},r.a.createElement(Q,{className:it.a.button,kind:"secondary",onClick:function(){return u(!l)},title:i}),l&&r.a.createElement("div",{className:it.a.calendarContainer},r.a.createElement(nt.a,Object.assign({maxDate:new Date,minDate:e,minDetail:"year",onChange:function(t,e){a&&a(t,e),u(!1)}},c))))},st=a(7),ot=a.n(st),lt=function(t){return y()(t).format("YYYY-M-D")},ut=function(){var t=Object(s.b)(),e=Object(l.h)().id,a=Object(s.c)(function(t){return function(e){var a=e.stations.favorites;return(void 0===a?[]:a).includes(t)}}(e)),i=Object(s.c)(u(e))||{},c=i.elevation,o=i.firstUpdated,m=i.lastUpdated,d=i.stationName,v=Object(s.c)(function(t){return function(e){var a=e.stations.items;return(void 0===a?{}:a)[t]}}(e))||[],p=Object(s.c)(f),_=Object(l.f)(),E=Object(l.g)().search,b=Object(M.parse)(E.substr(1)).date,O=b?y()(b,"YYYY-M-D"):y()(),g=O.format("MMMM YYYY");return Object(n.useEffect)((function(){e&&t(function(t){return function(){var e=Object(D.a)(w.a.mark((function e(a,n){var r,i,c,s,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u(t)(n())){e.next=2;break}return e.abrupt("return");case 2:return a(et(!0)),e.next=5,P(t);case 5:r=e.sent,(i=r.features).length,c=U(i),s=Object(S.a)(c,1),o=s[0],a({type:"STATIONS_UPDATE",stations:Object(B.a)({},t,o)}),a(et(!1));case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}(e))}),[t,e]),Object(n.useEffect)((function(){if(e){var a=function(t){var e=y()(t);return{day:e.format("D"),month:e.format("M"),year:e.format("YYYY")}}(b),n=a.month,r=a.year;t(function(t){var e=t.id,a=t.limit,n=t.month,r=t.year;return function(){var t=Object(D.a)(w.a.mark((function t(i,c){var s,o;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i(et(!0)),i(at(e,[])),t.next=4,F({id:e,limit:a,month:n,year:r});case 4:s=t.sent,o=s.features,i(at(e,(c=o,Object(k.sortBy)(c.map((function(t){var e=t.properties;return{date:e.LOCAL_DATE,maxTemperature:e.MAX_TEMPERATURE,minTemperature:e.MIN_TEMPERATURE,totalPrecipitation:e.TOTAL_PRECIPITATION}})),"date")))),i(et(!1));case 8:case"end":return t.stop()}var c}),t)})));return function(e,a){return t.apply(this,arguments)}}()}({id:e,month:n,year:r}))}}),[t,e,b]),r.a.createElement(h,{header:r.a.createElement(Q,{className:q()(ot.a.favoriteButton,Object(B.a)({},ot.a.favorite,a)),onClick:function(){return t(function(t,e){return function(){var a=Object(D.a)(w.a.mark((function a(n){return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",n({id:t,type:e?"FAVORITE_ADD":"FAVORITE_REMOVE"}));case 1:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()}(e,!a))},title:a?"Remove from favorites":"Add to favorites"})},r.a.createElement("div",{className:ot.a.stationPage},d&&r.a.createElement("div",{className:ot.a.station},r.a.createElement("h2",null,d),r.a.createElement("div",null,"Station elevation: ",c,"m"),r.a.createElement("div",null,"First updated: ",y()(o).format("YYYY-M-D")),r.a.createElement("div",null,"Last updated: ",y()(m).format("YYYY-M-D"))),v.length>0&&r.a.createElement("div",{className:ot.a.items},r.a.createElement(ct,{minDate:y()(o).toDate(),onChange:function(t){_.push({search:Object(M.stringify)({date:lt(t)})})},title:g,value:O.toDate()}),v.map((function(t){var e=t.date,a=t.maxTemperature,n=t.minTemperature,i=t.totalPrecipitation;return r.a.createElement("div",{className:q()(ot.a.item,Object(B.a)({},ot.a.selected,y()(e).isSame(O)))},r.a.createElement("div",{className:ot.a.day},y()(e).format("D")),r.a.createElement("div",{className:ot.a.temp},r.a.createElement("div",{className:ot.a.high},a),r.a.createElement("div",{className:ot.a.right},r.a.createElement("div",{className:ot.a.c},"\xb0C"),r.a.createElement("div",{className:ot.a.low},n))),r.a.createElement("div",{className:ot.a.mm},i,"mm"))}))),p&&r.a.createElement(X,{className:ot.a.loadingIndicator})))},mt=function(){return r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/stations/search",children:r.a.createElement(tt,null)}),r.a.createElement(l.a,{path:"/stations/:id",children:r.a.createElement(ut,null)}),r.a.createElement(l.a,{path:"/",children:r.a.createElement(I,null)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var dt=a(46),ft=(a(68),Object(dt.a)());c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,{store:ft},r.a.createElement(o.a,null,r.a.createElement(mt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},7:function(t,e,a){t.exports={stationPage:"styles_stationPage__14IdA",items:"styles_items__1J9qT",item:"styles_item__1P1ra",selected:"styles_selected__37TCM",day:"styles_day__2914Z",mm:"styles_mm__bgcXI",temp:"styles_temp__3F8zV",high:"styles_high__DLHV8",right:"styles_right__2lE8X",c:"styles_c__m44DG",low:"styles_low__2fGzc",loadingIndicator:"styles_loadingIndicator__1xERv",station:"styles_station__-hdqL",favoriteButton:"styles_favoriteButton__1K8-u",favorite:"styles_favorite__1JNtB"}}},[[51,1,2]]]);
//# sourceMappingURL=main.1c961799.chunk.js.map