(this["webpackJsonppine-time"]=this["webpackJsonppine-time"]||[]).push([[0],{23:function(e,t,a){e.exports={page:"styles_page__tlI5Y",header:"styles_header__1icdI",logo:"styles_logo__1nkjt",content:"styles_content__ka8Wk"}},24:function(e,t,a){e.exports={button:"styles_button__12U2K",primary:"styles_primary__3HQ5-",secondary:"styles_secondary__2pJ5d",loading:"styles_loading__3E_HN",loadingIndicator:"styles_loadingIndicator__3yut4"}},28:function(e,t,a){e.exports={datePicker:"styles_datePicker__3X6jL",button:"styles_button__2ydJx",calendarContainer:"styles_calendarContainer__7a9RA"}},34:function(e,t,a){e.exports={stationList:"styles_stationList__36qqT",meta:"styles_meta__2u-js"}},35:function(e,t,a){e.exports={home:"styles_home__2W7Yz",searchButton:"styles_searchButton__19h62"}},37:function(e,t,a){"use strict";var n=a(13),r=a(6),i=a(14),c=a(15);t.a=Object(c.c)({stations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{favorites:[],items:{},stations:{}},t=arguments.length>1?arguments[1]:void 0,a=t.type,c=Object(i.a)(t,["type"]);switch(a){case"FAVORITE_ADD":var s=c.id;if(e.favorites.includes(s))return e;var o=[].concat(Object(r.a)(e.favorites),[s]);return Object(n.a)({},e,{favorites:o});case"FAVORITE_REMOVE":var l=c.id,u=e.favorites.findIndex((function(e){return e===l}));if(-1===u)return e;var m=Object(r.a)(e.favorites);return m.splice(u,1),Object(n.a)({},e,{favorites:m});case"STATIONS_UPDATE":var d=Object(n.a)({},e.stations,{},c.stations);return Object(n.a)({},e,{stations:d});case"STATION_ITEMS_UPDATE":var f=Object(n.a)({},e.items,{},c.items);return Object(n.a)({},e,{items:f});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:0},t=arguments.length>1?arguments[1]:void 0,a=t.type,r=Object(i.a)(t,["type"]);switch(a){case"SET_LOADING":var c=e.loading+r.loading;return Object(n.a)({},e,{loading:c});default:return e}}})},44:function(e,t,a){e.exports={loadingIndicator:"styles_loadingIndicator__89poN"}},45:function(e,t,a){e.exports={search:"styles_search__MREa2"}},46:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return s}));var n=a(19),r=a(15),i=(a(47),a(48)),c=a(37),s=function(){var e=[i.a.withExtraArgument({})];var t=r.a.apply(void 0,e)(r.d),a=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),s=t(c.a,a);return s.subscribe((function(){s.subscribe(Object(n.throttle)((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(a){console.log("Failed to persist",a)}}({stations:s.getState().stations})}),1e3))})),s}}).call(this,a(39)(e))},51:function(e,t,a){e.exports=a(69)},68:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(26),c=a.n(i),s=a(11),o=a(17),l=a(5),u=function(e){return function(t){var a=t.stations.stations;return(void 0===a?{}:a)[e]}},m=function(e){var t=e.stations.stations;return void 0===t?{}:t},d=function(e){var t=e.stations.favorites;return void 0===t?[]:t},f=function(e){return e.ui.loading>0},p=a(14),v=function(e){var t=e.children,a=e.title,n=Object(p.a)(e,["children","title"]);return r.a.createElement(o.b,Object.assign({title:a},n),r.a.createElement("span",null,t||a))},_=a(23),E=a.n(_),h=function(e){var t=e.children,a=e.header;return r.a.createElement("div",{className:E.a.page},r.a.createElement("div",{className:E.a.header},r.a.createElement(v,{className:E.a.logo,to:"/"},r.a.createElement("h1",null,"Pine Time")),a),r.a.createElement("div",{className:E.a.content},t))},b=a(12),y=a.n(b),O=a(34),g=a.n(O),j=function(e){var t=e.stations;return r.a.createElement("ul",{className:g.a.stationList},t.map((function(e){var t=e.id,a=e.lastUpdated,n=e.province,i=e.stationName;return r.a.createElement("li",{key:t},r.a.createElement(v,{title:i,to:"/stations/".concat(t)},r.a.createElement("div",null,r.a.createElement("div",null,i),r.a.createElement("div",null,r.a.createElement("small",null,"Last updated: ",y()(a).format("YYYY-M-D")))),r.a.createElement("div",{className:g.a.meta},n)))})))},N=a(35),T=a.n(N),I=function(){var e=Object(s.c)(d),t=Object(s.c)(m),a=e.map((function(e){return t[e]}));return r.a.createElement(h,{header:r.a.createElement(v,{className:T.a.searchButton,title:"Search for a weather station",to:"/stations/search"})},r.a.createElement("div",{className:T.a.homePage},a&&a.length>0?r.a.createElement(j,{stations:a}):r.a.createElement("p",null,r.a.createElement(v,{title:"Search",to:"/stations/search"},"Search")," ","for weather stations.")))},A=a(2),w=a.n(A),D=a(4),S=a(8),Y=a(50),x=a(13),k=a(19),M=a(22),L={f:"json"},R=function(){var e=Object(D.a)(w.a.mark((function e(t){var a,n,r,i,c,s,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,n=t.options,r=void 0===n?{}:n,i=t.query,c=void 0===i?{}:i,s=Object(M.stringify)(Object(x.a)({},L,{},Object(k.omitBy)(c,(function(e){return!e})))),e.next=4,fetch("".concat("https://geo.weather.gc.ca/geomet/features/collections").concat(a,"?").concat(s),Object(x.a)({headers:{"Content-Type":"application/json"}},r));case 4:return o=e.sent,e.abrupt("return",o.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(D.a)(w.a.mark((function e(t){var a,n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.limit,n=void 0===a?30:a,r=t.stationName,e.abrupt("return",R({url:"/climate-stations/items",query:{limit:n,STATION_NAME:r}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(D.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",R({url:"/climate-stations/items",query:{CLIMATE_IDENTIFIER:t}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(D.a)(w.a.mark((function e(t){var a,n,r,i,c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.day,r=t.limit,i=void 0===r?30:r,c=t.month,s=t.year,e.abrupt("return",R({url:"/climate-daily/items/",query:{CLIMATE_IDENTIFIER:a,limit:i,LOCAL_YEAR:s,LOCAL_MONTH:c,LOCAL_DAY:n}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){return e.map((function(e){var t=e.geometry.coordinates,a=e.id,n=e.properties;return{coordinates:t,id:a,elevation:n.ELEVATION,firstUpdated:n.FIRST_DATE,lastUpdated:n.LAST_DATE,province:n.PROV_STATE_TERR_CODE,stationName:n.STATION_NAME}}))},B=a(3),V=a(16),q=a.n(V),J=a(42),G=a.n(J),H=a(44),W=a.n(H),X=function(e){var t=e.className,a=e.loading,n=void 0===a||a;return r.a.createElement("div",{className:q()(W.a.loadingIndicator,t)},r.a.createElement(G.a,{loading:n}))},z=a(24),K=a.n(z),Q=function(e){var t,a=e.children,n=e.className,i=e.disabled,c=e.kind,s=e.loading,o=void 0!==s&&s,l=e.title,u=Object(p.a)(e,["children","className","disabled","kind","loading","title"]);return r.a.createElement("button",Object.assign({className:q()(K.a.button,(t={},Object(B.a)(t,K.a[c],!!c),Object(B.a)(t,K.a.loading,o),Object(B.a)(t,n,!!n),t)),disabled:i||o,title:l},u),o&&r.a.createElement(X,{className:K.a.loadingIndicator}),r.a.createElement("span",null,a||l))},Z=a(45),$=a.n(Z),ee=function(){var e=Object(Y.a)({mode:"onChange"}),t=e.formState,a=t.isSubmitted,i=t.isSubmitting,c=t.isValid,s=e.handleSubmit,o=e.register,l=Object(n.useState)([]),u=Object(S.a)(l,2),m=u[0],d=u[1],f=a&&!i&&0===m.length,p=function(){var e=Object(D.a)(w.a.mark((function e(t){var a,n,r,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.stationName,e.next=3,C({stationName:a});case 3:n=e.sent,r=n.features,i=U(void 0===r?[]:r),d(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(h,null,r.a.createElement("div",{className:$.a.search},r.a.createElement("form",{name:"searchForm",onSubmit:s(p)},r.a.createElement("input",{autoFocus:!0,name:"stationName",placeholder:"Search for weather stations...",ref:o({required:!0}),type:"text"}),r.a.createElement(Q,{disabled:!c,kind:"primary",loading:i,title:"Search"})),m.length>0&&r.a.createElement(j,{stations:m}),f&&r.a.createElement("p",null,"No stations found.")))},te=function(e){return function(){var t=Object(D.a)(w.a.mark((function t(a){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a({loading:e?1:-1,type:"SET_LOADING"}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ae=function(e,t){return{type:"STATION_ITEMS_UPDATE",items:Object(B.a)({},e,t)}},ne=a(49),re=(a(67),a(28)),ie=a.n(re),ce=function(e){var t=e.minDate,a=e.onChange,i=e.title,c=Object(p.a)(e,["minDate","onChange","title"]),s=Object(n.useState)(!1),o=Object(S.a)(s,2),l=o[0],u=o[1];return r.a.createElement("div",{className:ie.a.datePicker},r.a.createElement(Q,{className:ie.a.button,kind:"secondary",onClick:function(){return u(!l)},title:i}),l&&r.a.createElement("div",{className:ie.a.calendarContainer},r.a.createElement(ne.a,Object.assign({maxDate:new Date,minDate:t,minDetail:"year",onChange:function(e,t){a&&a(e,t),u(!1)}},c))))},se=a(7),oe=a.n(se),le=function(e){return y()(e).format("YYYY-M-D")},ue=function(){var e,t=Object(s.b)(),a=Object(l.h)().id,i=Object(s.c)(function(e){return function(t){var a=t.stations.favorites;return(void 0===a?[]:a).includes(e)}}(a)),c=Object(s.c)(u(a))||{},o=c.elevation,m=c.firstUpdated,d=c.lastUpdated,p=c.stationName,v=Object(s.c)(function(e){return function(t){var a=t.stations.items;return(void 0===a?{}:a)[e]}}(a))||[],_=Object(s.c)(f),E=Object(l.f)(),b=Object(l.g)().search,O=Object(M.parse)(b.substr(1)).date,g=O?y()(O,"YYYY-M-D"):y()(),j=g.format("MMMM YYYY"),N={day:(e=g).format("D"),month:e.format("M"),year:e.format("YYYY")},T=N.month,I=N.year;return Object(n.useEffect)((function(){a&&t(function(e){return function(){var t=Object(D.a)(w.a.mark((function t(a,n){var r,i,c,s,o;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u(e)(n())){t.next=2;break}return t.abrupt("return");case 2:return a(te(!0)),t.next=5,P(e);case 5:r=t.sent,(i=r.features).length,c=U(i),s=Object(S.a)(c,1),o=s[0],a({type:"STATIONS_UPDATE",stations:Object(B.a)({},e,o)}),a(te(!1));case 12:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}(a))}),[t,a]),Object(n.useEffect)((function(){a&&t(function(e){var t=e.id,a=e.limit,n=e.month,r=e.year;return function(){var e=Object(D.a)(w.a.mark((function e(i,c){var s,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(te(!0)),i(ae(t,[])),e.next=4,F({id:t,limit:a,month:n,year:r});case 4:s=e.sent,o=s.features,i(ae(t,(c=o,Object(k.sortBy)(c.map((function(e){var t=e.properties;return{date:t.LOCAL_DATE,maxTemperature:t.MAX_TEMPERATURE,minTemperature:t.MIN_TEMPERATURE,totalPrecipitation:t.TOTAL_PRECIPITATION}})),"date")))),i(te(!1));case 8:case"end":return e.stop()}var c}),e)})));return function(t,a){return e.apply(this,arguments)}}()}({id:a,month:T,year:I}))}),[t,a,T,I]),r.a.createElement(h,{header:r.a.createElement(Q,{className:q()(oe.a.favoriteButton,Object(B.a)({},oe.a.favorite,i)),onClick:function(){return t(function(e,t){return function(){var a=Object(D.a)(w.a.mark((function a(n){return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",n({id:e,type:t?"FAVORITE_ADD":"FAVORITE_REMOVE"}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}(a,!i))},title:i?"Remove from favorites":"Add to favorites"})},r.a.createElement("div",{className:oe.a.stationPage},p&&r.a.createElement("div",{className:oe.a.station},r.a.createElement("h2",null,p),r.a.createElement("div",null,"Station elevation: ",o,"m"),r.a.createElement("div",null,"First updated: ",y()(m).format("YYYY-M-D")),r.a.createElement("div",null,"Last updated: ",y()(d).format("YYYY-M-D"))),r.a.createElement("div",{className:oe.a.items},r.a.createElement("div",{className:oe.a.filter},r.a.createElement(ce,{minDate:y()(m).toDate(),onChange:function(e){E.push({search:Object(M.stringify)({date:le(e)})})},title:j,value:g.toDate()})),v.length>0?v.map((function(e){var t=e.date,a=e.maxTemperature,n=e.minTemperature,i=e.totalPrecipitation;return r.a.createElement("div",{className:q()(oe.a.item,Object(B.a)({},oe.a.selected,y()(t).isSame(g))),key:t},r.a.createElement("div",{className:oe.a.day},y()(t).format("D")),r.a.createElement("div",{className:oe.a.temp},a&&n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:oe.a.high},a),r.a.createElement("div",{className:oe.a.right},r.a.createElement("div",{className:oe.a.c},"\xb0C"),r.a.createElement("div",{className:oe.a.low},n))):r.a.createElement("div",null,"N/A")),r.a.createElement("div",{className:oe.a.mm},"number"===typeof i?"".concat(i,"mm"):""))})):r.a.createElement("p",null,"Data not available.")),_&&r.a.createElement(X,{className:oe.a.loadingIndicator})))},me=function(){return r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/stations/search",children:r.a.createElement(ee,null)}),r.a.createElement(l.a,{path:"/stations/:id",children:r.a.createElement(ue,null)}),r.a.createElement(l.a,{path:"/",children:r.a.createElement(I,null)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var de=a(46),fe=(a(68),Object(de.a)());c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,{store:fe},r.a.createElement(o.a,null,r.a.createElement(me,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports={stationPage:"styles_stationPage__14IdA",items:"styles_items__1J9qT",filter:"styles_filter__1s-4h",item:"styles_item__1P1ra",selected:"styles_selected__37TCM",day:"styles_day__2914Z",mm:"styles_mm__bgcXI",temp:"styles_temp__3F8zV",high:"styles_high__DLHV8",right:"styles_right__2lE8X",c:"styles_c__m44DG",low:"styles_low__2fGzc",loadingIndicator:"styles_loadingIndicator__1xERv",station:"styles_station__-hdqL",favoriteButton:"styles_favoriteButton__1K8-u",favorite:"styles_favorite__1JNtB"}}},[[51,1,2]]]);
//# sourceMappingURL=main.3b3b29fb.chunk.js.map