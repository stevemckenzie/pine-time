(this["webpackJsonppine-time"]=this["webpackJsonppine-time"]||[]).push([[0],{19:function(t,e,a){t.exports={button:"styles_button__12U2K",primary:"styles_primary__3HQ5-",secondary:"styles_secondary__2pJ5d",loading:"styles_loading__3E_HN",children:"styles_children__1JDIs",loadingIndicator:"styles_loadingIndicator__3yut4"}},20:function(t,e,a){t.exports={stationPage:"styles_stationPage__14IdA",loadingIndicator:"styles_loadingIndicator__1xERv",favoriteButton:"styles_favoriteButton__1K8-u",favorite:"styles_favorite__1JNtB"}},23:function(t,e,a){t.exports={page:"styles_page__tlI5Y",header:"styles_header__1icdI",logo:"styles_logo__1nkjt",content:"styles_content__ka8Wk"}},32:function(t,e,a){t.exports={stationList:"styles_stationList__36qqT",meta:"styles_meta__2u-js"}},33:function(t,e,a){t.exports={home:"styles_home__2W7Yz",searchButton:"styles_searchButton__19h62"}},34:function(t,e,a){"use strict";var n=a(10),r=a(5),i=a(13),c=a(12);e.a=Object(c.c)({stations:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{favorites:[],items:{},stations:{}},e=arguments.length>1?arguments[1]:void 0,a=e.type,c=Object(i.a)(e,["type"]);switch(a){case"FAVORITE_ADD":var o=c.id;if(t.favorites.includes(o))return t;var s=[].concat(Object(r.a)(t.favorites),[o]);return Object(n.a)({},t,{favorites:s});case"FAVORITE_REMOVE":var u=c.id,l=t.favorites.findIndex((function(t){return t===u}));if(-1===l)return t;var m=Object(r.a)(t.favorites);return m.splice(l,1),Object(n.a)({},t,{favorites:m});case"STATIONS_UPDATE":var d=Object(n.a)({},t.stations,{},c.stations);return Object(n.a)({},t,{stations:d});case"STATION_ITEMS_UPDATE":var f=Object(n.a)({},t.items,{},c.items);return Object(n.a)({},t,{items:f});default:return t}},ui:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:0},e=arguments.length>1?arguments[1]:void 0,a=e.type,r=Object(i.a)(e,["type"]);switch(a){case"SET_LOADING":var c=t.loading+r.loading;return Object(n.a)({},t,{loading:c});default:return t}}})},42:function(t,e,a){t.exports={loadingIndicator:"styles_loadingIndicator__89poN"}},43:function(t,e,a){t.exports={search:"styles_search__MREa2"}},44:function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return o}));var n=a(17),r=a(12),i=(a(45),a(46)),c=a(34),o=function(){var t=[i.a.withExtraArgument({})];var e=r.a.apply(void 0,t)(r.d),a=function(){try{var t=localStorage.getItem("state");if(null===t)return;return JSON.parse(t)}catch(e){return}}(),o=e(c.a,a);return o.subscribe((function(){o.subscribe(Object(n.throttle)((function(){!function(t){try{var e=JSON.stringify(t);localStorage.setItem("state",e)}catch(a){console.log("Failed to persist",a)}}(o.getState())}),1e3))})),o}}).call(this,a(36)(t))},48:function(t,e,a){t.exports=a(65)},64:function(t,e,a){},65:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(25),c=a.n(i),o=a(9),s=a(15),u=a(4),l=function(t){return function(e){var a=e.stations.stations;return(void 0===a?{}:a)[t]}},m=function(t){var e=t.stations.stations;return void 0===e?{}:e},d=function(t){var e=t.stations.favorites;return void 0===e?[]:e},f=function(t){return t.ui.loading>0},p=a(13),v=function(t){var e=t.children,a=t.title,n=Object(p.a)(t,["children","title"]);return r.a.createElement(s.b,Object.assign({title:a},n),r.a.createElement("span",null,e||a))},E=a(23),h=a.n(E),_=function(t){var e=t.children,a=t.header;return r.a.createElement("div",{className:h.a.page},r.a.createElement("div",{className:h.a.header},r.a.createElement(v,{className:h.a.logo,to:"/"},r.a.createElement("h1",null,"Pine Time")),a),r.a.createElement("div",{className:h.a.content},e))},b=a(11),O=a.n(b),y=a(32),g=a.n(y),T=function(t){var e=t.stations;return r.a.createElement("ul",{className:g.a.stationList},e.map((function(t){var e=t.id,a=t.lastUpdated,n=t.province,i=t.stationName;return r.a.createElement("li",{key:e},r.a.createElement(v,{title:i,to:"/stations/".concat(e)},r.a.createElement("div",null,r.a.createElement("div",null,i),r.a.createElement("div",null,r.a.createElement("small",null,"Last updated: ",O()(a).format("YYYY-MM-DD")))),r.a.createElement("div",{className:g.a.meta},n)))})))},j=a(33),N=a.n(j),I=function(){var t=Object(o.c)(d),e=Object(o.c)(m),a=t.map((function(t){return e[t]}));return r.a.createElement(_,{header:r.a.createElement(v,{className:N.a.searchButton,title:"Search for a weather station",to:"/stations/search"})},r.a.createElement("div",{className:N.a.homePage},r.a.createElement(T,{stations:a})))},A=a(1),w=a.n(A),S=a(3),x=a(7),M=a(47),D=a(10),k=a(17),Y=a(39),R={f:"json"},L=function(){var t=Object(S.a)(w.a.mark((function t(e){var a,n,r,i,c,o,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.url,n=e.options,r=void 0===n?{}:n,i=e.query,c=void 0===i?{}:i,o=Object(Y.stringify)(Object(D.a)({},R,{},Object(k.omitBy)(c,(function(t){return!t})))),t.next=4,fetch("".concat("https://geo.weather.gc.ca/geomet/features/collections").concat(a,"?").concat(o),Object(D.a)({headers:{"Content-Type":"application/json"}},r));case 4:return s=t.sent,t.abrupt("return",s.json());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(S.a)(w.a.mark((function t(e){var a,n,r;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.limit,n=void 0===a?30:a,r=e.stationName,t.abrupt("return",L({url:"/climate-stations/items",query:{limit:n,STATION_NAME:r}}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Object(S.a)(w.a.mark((function t(e){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",L({url:"/climate-stations/items",query:{CLIMATE_IDENTIFIER:e}}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),U=function(){var t=Object(S.a)(w.a.mark((function t(e){var a,n,r,i,c,o;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,n=e.day,r=e.limit,i=void 0===r?30:r,c=e.month,o=e.year,t.abrupt("return",L({url:"/climate-daily/items/",query:{CLIMATE_IDENTIFIER:a,limit:i,LOCAL_YEAR:o,LOCAL_MONTH:c,LOCAL_DAY:n}}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),B=function(t){return t.map((function(t){var e=t.geometry.coordinates,a=t.id,n=t.properties;return{coordinates:e,id:a,elevation:n.ELEVATION,firstUpdated:n.FIRST_DATE,lastUpdated:n.LAST_DATE,province:n.PROV_STATE_TERR_CODE,stationName:n.STATION_NAME}}))},F=a(2),V=a(18),q=a.n(V),J=a(40),W=a.n(J),H=a(42),G=a.n(H),K=function(t){var e=t.className,a=t.loading,n=void 0===a||a;return r.a.createElement("div",{className:q()(G.a.loadingIndicator,e)},r.a.createElement(W.a,{loading:n}))},z=a(19),Q=a.n(z),X=function(t){var e,a=t.children,n=t.disabled,i=t.kind,c=t.loading,o=void 0!==c&&c,s=t.title,u=Object(p.a)(t,["children","disabled","kind","loading","title"]);return r.a.createElement("button",Object.assign({className:q()(Q.a.button,(e={},Object(F.a)(e,Q.a[i],!!i),Object(F.a)(e,Q.a.loading,o),e)),disabled:n||o,title:s},u),o&&r.a.createElement(K,{className:Q.a.loadingIndicator}),r.a.createElement("span",{className:Q.a.children},a||s))},$=a(43),Z=a.n($),tt=function(){var t=Object(M.a)({mode:"onChange"}),e=t.formState,a=e.isSubmitted,i=e.isSubmitting,c=e.isValid,o=t.handleSubmit,s=t.register,u=Object(n.useState)([]),l=Object(x.a)(u,2),m=l[0],d=l[1],f=a&&!i&&0===m.length,p=function(){var t=Object(S.a)(w.a.mark((function t(e){var a,n,r,i;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.stationName,t.next=3,P({stationName:a});case 3:n=t.sent,r=n.features,i=B(void 0===r?[]:r),d(i);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(_,null,r.a.createElement("div",{className:Z.a.search},r.a.createElement("form",{name:"searchForm",onSubmit:o(p)},r.a.createElement("input",{autoFocus:!0,name:"stationName",placeholder:"Search for weather stations...",ref:s({required:!0}),type:"text"}),r.a.createElement(X,{disabled:!c,kind:"primary",loading:i,title:"Search"})),m.length>0&&r.a.createElement(T,{stations:m}),f&&r.a.createElement("p",null,"No stations found.")))},et=function(t){return function(){var e=Object(S.a)(w.a.mark((function e(a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({loading:t?1:-1,type:"SET_LOADING"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},at=function(t){var e=t.headers,a=t.rows;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,e.map((function(t){return"string"===typeof t?r.a.createElement("th",{key:t,title:t},t):t})))),r.a.createElement("tbody",null,a.map((function(t,a){return r.a.createElement("tr",{key:a},t.map((function(t,a){return"object"===typeof t?t:r.a.createElement("td",{key:e[a]},t)})))}))))},nt=a(20),rt=a.n(nt),it=["Date","Min Temp","Max Temp","Mean Temp","Precipitation"],ct=function(){var t=Object(o.b)(),e=Object(u.f)().id,a=Object(o.c)(function(t){return function(e){var a=e.stations.favorites;return(void 0===a?[]:a).includes(t)}}(e)),i=Object(o.c)(l(e))||{},c=i.elevation,s=i.firstUpdated,m=i.lastUpdated,d=i.province,p=i.stationName,v=Object(o.c)(function(t){return function(e){var a=e.stations.items;return(void 0===a?{}:a)[t]}}(e))||[],E=v.map((function(t){var e=t.date,a=t.maxTemperature,n=t.meanTemperature,r=t.minTemperature,i=t.totalPrecipitation;return[O()(e).format("YYYY-MM-DD"),"".concat(r,"C"),"".concat(a,"C"),"".concat(n,"C"),i>0?"".concat(i,"mm"):0]})),h=Object(o.c)(f)&&!p;return Object(n.useEffect)((function(){e&&(t(function(t){return function(){var e=Object(S.a)(w.a.mark((function e(a,n){var r,i,c,o,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l(t)(n())){e.next=2;break}return e.abrupt("return");case 2:return a(et(!0)),e.next=5,C(t);case 5:r=e.sent,(i=r.features).length,c=B(i),o=Object(x.a)(c,1),s=o[0],a({type:"STATIONS_UPDATE",stations:Object(F.a)({},t,s)}),a(et(!1));case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}(e)),t(function(t){return function(){var e=Object(S.a)(w.a.mark((function e(a,n){var r,i,c,o,s,u;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(et(!0)),30,r=O()(),i=r.format("M"),c=r.format("YYYY"),e.next=7,U({id:t,limit:30,month:i,year:c});case 7:o=e.sent,s=o.features,n=s,u=Object(k.sortBy)(n.map((function(t){var e=t.properties;return{date:e.LOCAL_DATE,maxTemperature:e.MAX_TEMPERATURE,meanTemperature:e.MEAN_TEMPERATURE,minTemperature:e.MIN_TEMPERATURE,totalPrecipitation:e.TOTAL_PRECIPITATION}})),"date"),a({type:"STATION_ITEMS_UPDATE",items:Object(F.a)({},t,u)}),a(et(!1));case 12:case"end":return e.stop()}var n}),e)})));return function(t,a){return e.apply(this,arguments)}}()}(e)))}),[t,e]),r.a.createElement(_,{header:r.a.createElement(X,{className:q()(rt.a.favoriteButton,Object(F.a)({},rt.a.favorite,a)),onClick:function(){return t(function(t,e){return function(){var a=Object(S.a)(w.a.mark((function a(n){return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",n({id:t,type:e?"FAVORITE_ADD":"FAVORITE_REMOVE"}));case 1:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()}(e,!a))},title:a?"Remove from favorites":"Add to favorites"})},r.a.createElement("div",{className:rt.a.stationPage},h?r.a.createElement(K,{className:rt.a.loadingIndicator}):r.a.createElement("div",null,r.a.createElement("div",{className:rt.a.station},r.a.createElement("h2",null,p),r.a.createElement("div",null,d),r.a.createElement("div",null,"Station elevation: ",c,"m"),r.a.createElement("div",null,"First updated: ",O()(s).format("YYYY-MM-DD")),r.a.createElement("div",null,"Last updated: ",O()(m).format("YYYY-MM-DD"))),v.length>0&&r.a.createElement(at,{headers:it,rows:E}))))},ot=function(){return r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/stations/search",children:r.a.createElement(tt,null)}),r.a.createElement(u.a,{path:"/stations/:id",children:r.a.createElement(ct,null)}),r.a.createElement(u.a,{path:"/",children:r.a.createElement(I,null)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var st=a(44),ut=(a(64),Object(st.a)());c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:ut},r.a.createElement(s.a,null,r.a.createElement(ot,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.c0776eea.chunk.js.map